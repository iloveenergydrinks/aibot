#!/bin/bash

echo "üéß Twitter Spaces Audio Setup Script"
echo "======================================"
echo ""

# Install BlackHole
echo "üì¶ Installing BlackHole virtual audio device..."
echo "   (You'll need to enter your password)"
echo ""

brew install blackhole-2ch

if [ $? -eq 0 ]; then
    echo ""
    echo "‚úÖ BlackHole installed!"
    echo ""
    echo "‚ö†Ô∏è  IMPORTANT: You must REBOOT your Mac for BlackHole to work!"
    echo ""
    echo "After reboot:"
    echo "  1. Open 'Audio MIDI Setup' app"
    echo "  2. Follow the configuration steps below"
    echo ""
else
    echo ""
    echo "‚ùå Installation failed or requires password"
    echo ""
    echo "Manual installation:"
    echo "  1. Go to: https://existential.audio/blackhole/"
    echo "  2. Download BlackHole 2ch"
    echo "  3. Install the .pkg file"
    echo "  4. Reboot your Mac"
    echo ""
fi

echo "======================================"
echo "üìã CONFIGURATION STEPS (After Reboot)"
echo "======================================"
echo ""
echo "Step 1: Open 'Audio MIDI Setup'"
echo "  ‚Ä¢ Applications ‚Üí Utilities ‚Üí Audio MIDI Setup"
echo ""
echo "Step 2: Create Multi-Output Device"
echo "  ‚Ä¢ Click '+' (bottom left)"
echo "  ‚Ä¢ Choose 'Create Multi-Output Device'"
echo "  ‚Ä¢ Name it: 'Spaces Output'"
echo "  ‚Ä¢ Check BOTH:"
echo "    ‚úÖ BlackHole 2ch"
echo "    ‚úÖ MacBook Pro Speakers (or your speakers)"
echo ""
echo "Step 3: Create Aggregate Device"
echo "  ‚Ä¢ Click '+' again"
echo "  ‚Ä¢ Choose 'Create Aggregate Device'"
echo "  ‚Ä¢ Name it: 'Spaces Input'"
echo "  ‚Ä¢ Check BOTH:"
echo "    ‚úÖ BlackHole 2ch"
echo "    ‚úÖ MacBook Pro Microphone (or your mic)"
echo ""
echo "Step 4: Set as System Default"
echo "  ‚Ä¢ System Settings ‚Üí Sound"
echo "  ‚Ä¢ Output: Select 'Spaces Output'"
echo "  ‚Ä¢ Input: Select 'Spaces Input'"
echo ""
echo "======================================"
echo "üß™ TESTING"
echo "======================================"
echo ""
echo "After setup, run:"
echo "  python3 test_blackhole.py"
echo ""
echo "This will verify BlackHole is working!"
echo ""


